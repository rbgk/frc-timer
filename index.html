<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <title>Rebuilt Match Timer</title>
        <meta name="description" content="Match timer for FRC Rebuilt to keep track of match periods" />

        <!-- PWA essentials -->
        <link rel="manifest" href="manifest.json" />
        <meta name="theme-color" content="#0d6efd" />

        <!-- iOS support -->
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="default" />
        <meta name="apple-mobile-web-app-title" content="My PWA" />
        <link rel="apple-touch-icon" href="icons/icon-192.png" />

        <!-- Fallback icon -->
        <link rel="icon" href="icons/icon-192.png" />

        <link rel="stylesheet" href="style.css">
        <script defer src="script.js"></script>
    </head>
    <body id="body" onload="init()">
        <div id="timers"></div>



        <button onclick="vibrate()">
            click for vibrate
        </button>

        <button onclick="swapAlliance()">
            Swap Alliance
        </button>

        <script>
            const alliance = "alliance";
            const cookieDomain = "rbgk.github.io/frc-timer";
            const expireTime = 365;

            function getCookie(key) {
                const value = `; ${document.cookie}`;
                const parts = value.split(`; ${key}=`);
                if (parts.length === 2) return parts.pop().split(';').shift();
            }

            // Setting a cookie
            function setCookie(key, value, days, domain) {
                let expires = "";
                if (days) {
                    const date = new Date();
                    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                    expires = "; expires=" + date.toUTCString();
                }
                const domainStr = domain ? "; domain=" + domain : "";
                document.cookie = `${key}=${value || ""}${expires}; path=/${domainStr}`;
            }

            function init() {
                setCookie(alliance, "red");
                document.getElementById("body").style.backgroundColor = "var(--r-alliance)";
            }

            function swapAlliance() {
                getCookie(alliance) === "red" ? setCookie(alliance, "blue") : setCookie(alliance, "red");

                switch (getCookie(alliance)) {
                    case "red":
                        document.getElementById("body").style.backgroundColor = "var(--r-alliance)";
                        break;

                    case "blue":
                        document.getElementById("body").style.backgroundColor = "var(--b-alliance)";
                        break;

                    default:
                        document.getElementById("body").style.backgroundColor = "var(--r-alliance)";
                        break;
                }
            }

            function vibrate() {
                window.navigator.vibrate([250, 50, 250, 50, 500]);
            }
        </script>




        <!-- <script>
            if ("serviceWorker" in navigator) {
                window.addEventListener("load", () => {
                    navigator.serviceWorker
                        .register("sw.js")
                        .then((reg) => console.log("SW registered:", reg.scope))
                        .catch((err) =>
                            console.error("SW registration failed:", err),
                        );
                });
            }
        </script> -->
    </body>
</html>
